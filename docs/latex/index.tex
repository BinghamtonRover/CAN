\label{index_md_README}%
\Hypertarget{index_md_README}%
 Provides common CAN bus functionality for the Teensy controllers aboard the rover using the \href{https://github.com/tonton81/FlexCAN_T4}{\texttt{ Flex\+CAN\+\_\+\+T4}} library. Make sure to install that before using it\hypertarget{index_autotoc_md1}{}\doxysection{Usage}\label{index_autotoc_md1}
First, include the library in your code\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <\mbox{\hyperlink{_b_u_r_t__can_8h}{BURT\_can.h}}>}}

\end{DoxyCode}


Next, you need to initialize the library\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} setup() \{}
\DoxyCodeLine{  \textcolor{comment}{// ...}}
\DoxyCodeLine{  \mbox{\hyperlink{class_burt_can_a4a2407abb36ee4e5d23696ff1c868cc4_a4a2407abb36ee4e5d23696ff1c868cc4}{BurtCan::setup}}();}
\DoxyCodeLine{\}}

\end{DoxyCode}


See the sketches in the {\ttfamily examples} directory for examples.\hypertarget{index_autotoc_md2}{}\doxysubsection{Receiving messages}\label{index_autotoc_md2}
CAN works best via callbacks instead of checking for messages. To simplify message handling, CAN uses “mailboxes” that each pick up messages with a certain ID. The ID, in our case, is a combination of the device being targeted and the command it is being sent. Thus, whenever a CAN message is received, exactly one handler should run to execute the command.

Your handler function needs to be a {\ttfamily Can\+Handler}\+: {\ttfamily const Can\+Message\&} as input and {\ttfamily void} output. {\ttfamily Can\+Message}s have their ID in {\ttfamily message.\+id} and data in {\ttfamily message.\+buf}.


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} handler(\textcolor{keyword}{const} \mbox{\hyperlink{_b_u_r_t__can_8h_a85e783316bbdcbbb61711e2822333223_a85e783316bbdcbbb61711e2822333223}{CanMessage}}\& message) \{ }
\DoxyCodeLine{  Serial.print(\textcolor{stringliteral}{"{}Received signal with data: "{}});}
\DoxyCodeLine{  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} index = 0; index < 8; index++) \{}
\DoxyCodeLine{    Serial.print(message.buf[index]);}
\DoxyCodeLine{    Serial.print(\textcolor{stringliteral}{"{} "{}});}
\DoxyCodeLine{  \}}
\DoxyCodeLine{  Serial.print(\textcolor{stringliteral}{"{}\(\backslash\)n"{}});}
\DoxyCodeLine{\}}

\end{DoxyCode}


Register your handler in {\ttfamily setup}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{preprocessor}{\#define SIGNAL\_ID 1}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} setup() \{}
\DoxyCodeLine{  \textcolor{comment}{// ...}}
\DoxyCodeLine{  \mbox{\hyperlink{class_burt_can_a4a2407abb36ee4e5d23696ff1c868cc4_a4a2407abb36ee4e5d23696ff1c868cc4}{BurtCan::setup}}();}
\DoxyCodeLine{  \mbox{\hyperlink{class_burt_can_a0e87852581ef690086342a48a291d569_a0e87852581ef690086342a48a291d569}{BurtCan::registerHandler}}(SIGNAL\_ID, handler);}
\DoxyCodeLine{\}}

\end{DoxyCode}


Be sure to listen for incoming messages in {\ttfamily loop}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{\textcolor{keywordtype}{void} loop() \{}
\DoxyCodeLine{  \textcolor{comment}{// ...}}
\DoxyCodeLine{  \mbox{\hyperlink{class_burt_can_ab549af8dc00d6f7c4f02af0055628fd1_ab549af8dc00d6f7c4f02af0055628fd1}{BurtCan::update}}();}
\DoxyCodeLine{\}}

\end{DoxyCode}
\hypertarget{index_autotoc_md3}{}\doxysubsection{Sending messages}\label{index_autotoc_md3}
To send a message of bytes, use {\ttfamily send}\+:


\begin{DoxyCode}{0}
\DoxyCodeLine{uint8\_t data[] = \{1, 2, 3, 4, 5, 6, 7, 8\};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{void} loop() \{}
\DoxyCodeLine{  \mbox{\hyperlink{class_burt_can_a238e2df76151f9b512bb2211ee25d620_a238e2df76151f9b512bb2211ee25d620}{BurtCan::send}}(SIGNAL\_ID, data);}
\DoxyCodeLine{  delay(1000);}
\DoxyCodeLine{\}}

\end{DoxyCode}
 